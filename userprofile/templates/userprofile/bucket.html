{% extends 'main.html' %}
{% load static %}
{% block content %}

<section id="current-order" class="border-bottom">
  <div class="row">
    {% for product in order_products %}
    <div class="col-md-2 p-3">
      <div class="image-container d-flex">
        <img class="img img-fluid w-50 mx-auto" src="{{ product.product_id.featured_img.url }}" />
      </div>

      <!-- BUTTONS INCRESE/DECREASE/DELETE -->
      <div class="row">
        <div class="col-lg-6">
        <div class="btn-group btn-group-sm d-flex justify-content-center bg-light p-2" role="group" aria-label="Small button group">
          <form action="{% url 'increase_item' product.id %}" method="POST">
            {% csrf_token %}
          <button type="submit" class="btn btn-sm btn-outline-primary text-center ms-1" style="width: 35px;" name="{{product.id}}">+</button>
          </form>
    
          <form action="{% url 'decrease_item' product.id %}" method="POST">
              {% csrf_token %}
          <button type="submit" class="btn btn-sm btn-outline-primary text-center ms-1" style="width: 35px;" name="{{product.id}}">-</button>
          </form>
        </div>
      </div>

      <div class="col-lg-6 p-2">
        <form class="d-flex" action="{% url 'delete_item' product.id %}" method="POST">
          {% csrf_token %}
        <button type="submit" class="btn btn-sm btn-danger mx-auto" name="{{product.id}}">Видалити</button>
        </form>
      </div>

      </div>


    </div>

    <div class="col-md-8 p-3 bg-light">
      <h5 class="text-primary"><a href="{% url 'goods_article' product.product_id.id %}">{{ product.product_id.name }}</a></h5>
      <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Delectus id ut ad est maiores, eos, deleniti voluptates ratione fugit eveniet temporibus illo, voluptatibus incidunt pariatur a eius non hic esse perferendis vero! Consequuntur repellendus nihil quisquam vitae ipsam. Omnis, molestiae!</p>
    </div>

    <div class="col-md-2 bg-light d-flex">
      <p class="lead d-flex align-items-center">{{ product.count }} x {{product.product_id.price}}</p>
    </div> 
    {% endfor %}
  </div>
</section>

<!-- Total SUM -->
<section id="total-sum">
  <div class="row">
    <div class="col text-center">
        <h4 class="ms-4 my-4">Всього до сплати: {{total_sum}}</h4>
        <a class="btn btn-success w-50 d-flex mx-auto justify-content-center" href="{% url 'goods_processing' %}" id="bucket-button">ОФОРМИТИ</a>
    </div>
  </div>
</section>

<!-- PREVIOUS ORDERS -->

<section id="previousOrders" class="mt-5">
  {% if order_cards %}
  <div class="header bg-primary text-center py-3">
    <h4 class="text-white">Попередні замовлення</h4>
  </div>

  <ul class="list-group list-group-flush">
    {% for card in order_cards %} 
    <li class="list-group-item list-group-item-dark pt-4"><p class="lead">{{card.created|date:'Y-m-d'}} | сума = {{card.total}} | статус: {{card.status}} <a class="btn btn-sm btn-outline-primary" href="{% url 'user_order' card.id%}">Детальніше</a></p></li>
    {% endfor %} 
  </ul>
  {% endif %}
</section>

{% endblock content %}